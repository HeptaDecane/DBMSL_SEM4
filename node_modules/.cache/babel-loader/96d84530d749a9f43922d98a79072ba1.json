{"ast":null,"code":"import _defineProperty from\"/home/near/Alpha/Stack/IPR-Portal/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"/home/near/Alpha/Stack/IPR-Portal/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/near/Alpha/Stack/IPR-Portal/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/near/Alpha/Stack/IPR-Portal/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/near/Alpha/Stack/IPR-Portal/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from\"react\";import{Link,Redirect}from'react-router-dom';import axios from'axios';import TextField from\"material-ui/TextField\";import MuiThemeProvider from\"material-ui/styles/MuiThemeProvider\";import RaisedButton from\"material-ui/RaisedButton\";var styles={button:{margin:15}};export var VerifyEmail=/*#__PURE__*/function(_React$Component){_inherits(VerifyEmail,_React$Component);var _super=_createSuper(VerifyEmail);function VerifyEmail(props){var _this;_classCallCheck(this,VerifyEmail);_this=_super.call(this,props);_this.changeHandler=function(e){_this.setState(_defineProperty({},e.target.id,e.target.value));};_this.submitHanler=function(e){var data={};data.otp=_this.state.otp;data.resend=false;console.log(data);var authAxios=axios.create({headers:{Authorization:\"Token \".concat(localStorage.getItem('token'))}});authAxios.post('http://104.197.122.210:8000/api/default/',data).then(function(response){_this.setState({emailVerified:response.data.email_verified});console.log(response);}).catch(function(error){_this.setState({error:error.response});console.log(_this.state.error);});};_this.resendOTP=function(e){var data={};data.resend=true;console.log(data);var authAxios=axios.create({headers:{Authorization:\"Token \".concat(localStorage.getItem('token'))}});authAxios.post('http://104.197.122.210:8000/api/default/',data).then(function(response){_this.setState({});console.log(response);}).catch(function(error){_this.setState({error:error.response});console.log(_this.state.error);});};_this.state={emailVerified:false,authenticated:true,email:\"\",otp:\"\"};return _this;}_createClass(VerifyEmail,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;var authAxios=axios.create({headers:{Authorization:\"Token \".concat(localStorage.getItem('token'))}});authAxios.get('http://104.197.122.210:8000/api/default/').then(function(response){_this2.setState({email:response.data.email,authenticated:true,emailVerified:response.data.email_verified});console.log(_this2.state.email);console.log(_this2.state.emailVerified);}).catch(function(error){_this2.setState({error:error.response});console.log(_this2.state.error);if(_this2.state.error.status===423){_this2.setState({emailVerified:true});}if(_this2.state.error.status===401){_this2.setState({authenticated:false});}});}},{key:\"render\",value:function render(){var _this$state=this.state,min=_this$state.min,sec=_this$state.sec,emailVerified=_this$state.emailVerified,authenticated=_this$state.authenticated,email=_this$state.email,otp=_this$state.otp;if(!authenticated){return/*#__PURE__*/React.createElement(Redirect,{to:\"/login\"});}if(emailVerified){return/*#__PURE__*/React.createElement(Redirect,{to:\"/profile\"});}return/*#__PURE__*/React.createElement(MuiThemeProvider,null,/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"h2\",null,\"User Verification\"),/*#__PURE__*/React.createElement(\"h5\",null,email),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(TextField,{hintText:\"6 digit otp\",floatingLabelText:\"6 Digit OTP\",id:\"otp\",value:otp,onChange:this.changeHandler}),/*#__PURE__*/React.createElement(RaisedButton,{label:\"verify\",primary:true,style:styles.button,onClick:this.submitHanler,type:\"submit\"}),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(RaisedButton,{label:\"Send OTP\",primary:true,style:styles.button,onClick:this.resendOTP,type:\"submit\"}),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(Link,{to:\"/logout\"},/*#__PURE__*/React.createElement(RaisedButton,{label:\"Logout\",primary:false,style:styles.button}))));}}]);return VerifyEmail;}(React.Component);export default VerifyEmail;// OTP TIMER\n// this.myInterval = setInterval(() => {\n//     const { min, sec } = this.state;\n//     if (sec > 0) {\n//         this.setState(({ sec }) => ({\n//         sec: sec - 1,\n//         }));\n//     }\n//     if (sec === 0) {\n//         if (min === 0) {\n//         clearInterval(this.myInterval);\n//         } else {\n//             this.setState(({ min }) => ({\n//                 min: min - 1,\n//                 sec: 59,\n//             }));\n//         }\n//     }   \n// }, 1000);","map":{"version":3,"sources":["/home/near/Alpha/Stack/IPR-Portal/frontend/src/components/VerifyEmail.js"],"names":["React","Link","Redirect","axios","TextField","MuiThemeProvider","RaisedButton","styles","button","margin","VerifyEmail","props","changeHandler","e","setState","target","id","value","submitHanler","data","otp","state","resend","console","log","authAxios","create","headers","Authorization","localStorage","getItem","post","then","response","emailVerified","email_verified","catch","error","resendOTP","authenticated","email","get","status","min","sec","Component"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport {Link,Redirect} from 'react-router-dom';\nimport axios from 'axios';\nimport TextField from \"material-ui/TextField\";\nimport MuiThemeProvider from \"material-ui/styles/MuiThemeProvider\";\nimport RaisedButton from \"material-ui/RaisedButton\";\n\nconst styles = {\n    button: {\n        margin: 15,\n    },\n};\n\nexport class VerifyEmail extends React.Component {\n    constructor(props) {\n        super(props)\n  \n        this.state = {\n            emailVerified: false,\n            authenticated:true,\n            email:\"\",\n            otp:\"\",\n        }\n    }\n\n    changeHandler = (e)=>{\n        this.setState({\n            [e.target.id]: e.target.value\n        })\n    }\n\n    submitHanler = (e)=>{        \n        let data={}\n        data.otp = this.state.otp\n        data.resend = false\n        console.log(data)\n\n        let authAxios=axios.create({\n            headers: {\n                Authorization: `Token ${localStorage.getItem('token')}`\n            }\n        });\n        authAxios.post('http://104.197.122.210:8000/api/default/',data)\n        .then(\n            (response)=>{\n                this.setState({\n                    emailVerified: response.data.email_verified\n                })\n                console.log(response)\n            }\n        )\n        .catch(\n            (error)=>{\n                this.setState({error: error.response})\n                console.log(this.state.error)\n            }\n        )\n    }\n\n    resendOTP = (e)=>{        \n        let data={}\n        data.resend = true\n        console.log(data)\n\n        let authAxios=axios.create({\n            headers: {\n                Authorization: `Token ${localStorage.getItem('token')}`\n            }\n        });\n        authAxios.post('http://104.197.122.210:8000/api/default/',data)\n        .then(\n            (response)=>{\n                this.setState({\n                    \n                })\n                console.log(response)\n            }\n        )\n        .catch(\n            (error)=>{\n                this.setState({error: error.response})\n                console.log(this.state.error)\n            }\n        )\n    }\n\n    componentDidMount() {\n        let authAxios=axios.create({\n            headers: {\n                Authorization: `Token ${localStorage.getItem('token')}`\n            }\n        });\n        authAxios.get('http://104.197.122.210:8000/api/default/')\n        .then(\n            (response)=>{\n                this.setState({\n                    email:response.data.email,\n                    authenticated: true,\n                    emailVerified: response.data.email_verified,\n                })\n                console.log(this.state.email)\n                console.log(this.state.emailVerified)\n            }\n        )\n        .catch(\n            (error)=>{\n                this.setState({\n                    error:error.response,\n                })\n                console.log(this.state.error)\n                if(this.state.error.status===423){\n                    this.setState({emailVerified:true})\n                }\n                if(this.state.error.status===401){\n                    this.setState({authenticated:false})\n                }\n            }\n        )\n    }\n\n    render() {\n        let {min,sec,emailVerified,authenticated,email,otp} = this.state;\n\n        if(!authenticated){\n            return(<Redirect to=\"/login\" />)\n        }\n        if(emailVerified){\n            return(<Redirect to=\"/profile\" />)\n        }\n\n        return (\n            <MuiThemeProvider>\n                <React.Fragment>\n                    <br/><br/>\n                    <h2>User Verification</h2>\n                    <h5>{email}</h5>\n                    <br/><br/>\n                    <TextField\n                        hintText=\"6 digit otp\"\n                        floatingLabelText=\"6 Digit OTP\"\n                        id=\"otp\"\n                        value={otp}\n                        onChange={this.changeHandler}\n                    />\n                    <RaisedButton\n                        label=\"verify\"\n                        primary={true}\n                        style={styles.button}\n                        onClick={this.submitHanler}\n                        type=\"submit\"\n\n                    />\n                    <br/><br/>\n                    <RaisedButton\n                        label=\"Send OTP\" \n                        primary={true}\n                        style={styles.button}\n                        onClick={this.resendOTP}\n                        type=\"submit\"\n                    />\n                    <br/><br/>\n                    <Link to=\"/logout\">\n                        <RaisedButton   \n                            label=\"Logout\"\n                            primary={false} \n                            style={styles.button} \n                        />\n                    </Link>\n                </React.Fragment>\n            </MuiThemeProvider>\n        );\n    }\n}\n\nexport default VerifyEmail\n\n\n        // OTP TIMER\n        // this.myInterval = setInterval(() => {\n        //     const { min, sec } = this.state;\n\n        //     if (sec > 0) {\n        //         this.setState(({ sec }) => ({\n        //         sec: sec - 1,\n        //         }));\n        //     }\n        //     if (sec === 0) {\n        //         if (min === 0) {\n        //         clearInterval(this.myInterval);\n        //         } else {\n        //             this.setState(({ min }) => ({\n        //                 min: min - 1,\n        //                 sec: 59,\n        //             }));\n        //         }\n        //     }   \n        // }, 1000);\n"]},"metadata":{},"sourceType":"module"}